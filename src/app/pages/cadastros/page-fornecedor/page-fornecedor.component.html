<crud [componente]="this" permissao="" titulo="Fornecedor">
    <div detalhes>
        <div class="ui-g">
            <div class="ui-g-12">
                <div class="row">

                    <div class="ui-g-12" style="font-size: 14px !important;font-family: sans-serif;">
                        <p-selectButton [options]="listaPessoas" [(ngModel)]="objetoSelecionado.pessoa.tipoPessoa">
                        </p-selectButton>
                    </div>

                    <div class="ui-g-12" *ngIf="objetoSelecionado.id != null || objetoSelecionado.id != undefined">
                        <inputText id="id" md="1" disabled="true" label="Código"
                            [(ngModel)]="objetoSelecionado.pessoa.id">
                        </inputText>
                    </div>

                    <div class="ui-g-12 ui-md-2">
                        <inputMask id="cpfCnpj" maxlength="19" md="12" class="abc"
                            [label]="objetoSelecionado.pessoa.tipoPessoa == 'FISICA' ? 'CPF': 'CNPJ'"
                            [mask]="objetoSelecionado.pessoa.tipoPessoa == 'FISICA' ? '999.999.999-99': '99.999.999/9999-99'"
                            [(ngModel)]="objetoSelecionado.pessoa.cpfCnpj"
                            [placeholder]="objetoSelecionado.pessoa.tipoPessoa == 'FISICA' ? '___.___.___-__': '__.___.___/____-__'">
                        </inputMask>
                    </div>

                    <div class="ui-g-12 ui-md-5">
                        <inputText id="razaoSocial" maxlength="60" md="12"
                            [label]="objetoSelecionado.pessoa.tipoPessoa == 'FISICA' ? 'Nome da Empresa': 'Razão Social'"
                            [(ngModel)]="objetoSelecionado.pessoa.nomePessoa"></inputText>
                    </div>

                    <div class="ui-g-12 ui-md-5">
                        <inputText id="fantasia" maxlength="60" md="12" label="Fantasia"
                            [(ngModel)]="objetoSelecionado.pessoa.nomeFantasia"></inputText>
                    </div>

                    <div class="ui-g-12 ui-md-2">
                        <inputText id="ieRg" maxlength="12" md="12"
                            [label]="objetoSelecionado.pessoa.tipoPessoa == 'FISICA' ? 'RG': 'Inscrição Estadual'"
                            [(ngModel)]="objetoSelecionado.pessoa.ieRg">
                        </inputText>
                    </div>

                    <div class="ui-g-12 ui-md-5">
                        <inputText id="email" md="12" label="Email" maxlength="100"
                            [(ngModel)]="objetoSelecionado.pessoa.email">
                        </inputText>
                    </div>

                    <div class="ui-g-12 ui-md-6">

                        <p-table [value]="objetoSelecionado.pessoa.listEndereco" selectionMode="single"
                            [resizableColumns]="true" [scrollable]="true" scrollHeight="100px"
                            [(selection)]="enderecoTabela" [responsive]="false"
                            (onRowSelect)="onRowSelectEndereco($event)" (onRowUnselect)="onRowUnselectEndereco($event)">

                            <ng-template pTemplate="caption">

                                <div style="position: relative;top: -5px;">
                                    <label style="float: left;" class="mt-2"><i class="fa fa-map-marker"></i>
                                        Endereço</label>
                                    <button label="Incluir" (click)="adicionarEndereco()" icon="fa fa-plus"
                                        pButton></button>
                                    <button label="Editar" (click)="editarEndereco()" icon="fa fa-edit"
                                        pButton></button>
                                    <button label="Remover" (click)="removerEndereco()" icon="fa fa-trash"
                                        pButton></button>
                                </div>
                            </ng-template>

                            <ng-template pTemplate="header">
                                <tr>
                                    <th style="text-align: center;width: 85px !important;">cep</th>
                                    <th style="text-align: justify;width: 200px !important;">Logradouro</th>
                                    <th style="text-align: center;width: 90px !important;">bairro</th>
                                    <th style="text-align: justify;width: 200px !important;">complemento</th>
                                    <th style="text-align: center;width: 75px !important;">numero</th>
                                    <th style="text-align: center;width: 100px !important;">cidade</th>
                                    <th style="text-align: center;width: 80px !important;">estado</th>
                                </tr>
                            </ng-template>
                            <ng-template pTemplate="body" let-item let-rowIndex="rowIndex">
                                <tr [pSelectableRow]="item" [pSelectableRowIndex]="rowIndex">
                                    <td style="text-align: center;width: 85px !important;">{{item.cep}}</td>
                                    <td style="text-align: justify;width: 200px !important;">{{item.logradouro}}</td>
                                    <td style="text-align: center;width: 90px !important;">{{item.bairro}}</td>
                                    <td style="text-align: justify;width: 200px !important;">{{item.complemento}}</td>
                                    <td style="text-align: center;width: 75px !important;">{{item.numero}}</td>
                                    <td style="text-align: center;width: 100px !important;">{{item.cidade.xmun}}</td>
                                    <td style="text-align: center;width: 80px !important;">{{item.estado.uf}}</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>

                    <div class="ui-g-12 ui-md-6">

                            <p-table [value]="objetoSelecionado.pessoa.listaTelefone" 
                            selectionMode="single" [resizableColumns]="true" [scrollable]="true" scrollHeight="100px"
                            [(selection)]="telefoneTabela" [responsive]="false"
                            (onRowSelect)="onRowSelectTelefone($event)" (onRowUnselect)="onRowUnselectTelefone($event)">

                            <ng-template pTemplate="caption">

                                <div style="position: relative;top: -5px;">
                                    <label style="float: left;" class="mt-2"><i class="fa fa-phone-square"></i>
                                        Telefone</label>

                                    <button label="Incluir" (click)="adicionarTelefone()" icon="fa fa-plus"
                                        pButton></button>
                                    <button label="Editar" (click)="editarTelefone()" icon="fa fa-edit"
                                        pButton></button>
                                    <button label="Remover" (click)="removerTelefone()" icon="fa fa-trash"
                                        pButton></button>
                                </div>
                            </ng-template>

                            <ng-template pTemplate="header">
                                <tr>
                                    <th style="text-align: center;width: 10px !important;">Tipo</th>
                                    <th style="text-align: center;width: 20px !important;">Operadora</th>
                                    <th style="text-align: center;width: 40px !important;">Número</th>
                                </tr>
                            </ng-template>

                            <ng-template pTemplate="body" let-item let-rowIndex="rowIndex" >
                                <tr [pSelectableRow]="item" [pSelectableRowIndex]="rowIndex">
                                    <td style="text-align: center;width: 10px !important;">{{item.tipo}}</td>
                                    <td style="text-align: center;width: 20px !important;">{{item.nmOperadora}}</td>
                                    <td style="text-align: justify;width: 40px !important;">{{item.numero}}</td>
                                </tr>
                            </ng-template>
                        </p-table>
                    </div>
                </div>

                <p-dialog header="Endereço Fornecedor" [(visible)]="isVisibleEndereco" [modal]="true"
                    [closeOnEscape]="true" [style]="{'width': '70%'}" [responsive]="true" [minY]="70"
                    [maximizable]="false" [baseZIndex]="10000">
                    <div class="ui-g" style="height: 420px;">
                        <div class="ui-g-12">
                            <div class="row">
                                <div class="ui-g-12" style="font-size: 14px !important;font-family: sans-serif;">
                                    <p-selectButton [options]="statusEndereco" [(ngModel)]="enderecoSelecionado.ativo">
                                    </p-selectButton>
                                </div>

                                <div class="ui-g-12 ui-md-12">
                                    <inputMask id="cep" placeholder="_____-___" mask="99999-999" md="12" label="CEP"
                                        [disabled]="!enderecoSelecionado.ativo" autocomplete="off"
                                        [(ngModel)]="enderecoSelecionado.cep" (onChange)="carregarEnderecoPeloCep()">
                                    </inputMask>
                                    <p-progressSpinner *ngIf="progressSpinner" [style]="{width: '50px', height: '25px'}"
                                        strokeWidth="5" fill="#EEEEEE" animationDuration=".5s"></p-progressSpinner>
                                    <p-message class="col-md-3 mb-1" *ngIf="errocep && enderecoSelecionado.cep != '' "
                                        severity="error" text="CEP invalido"
                                        [style]="{width: '50px', height: '50px', top: '50px' }">
                                    </p-message>
                                </div>

                                <div class="ui-g-12 ui-md-4 ui-lg-3">
                                    <label>Estado</label><br>
                                    <p-dropdown id="estado" autocomplete="off" [options]="listaEstado"
                                        [disabled]="!enderecoSelecionado.ativo" (onChange)="carregarCidades()"
                                        [filter]="true" [(ngModel)]="enderecoSelecionado.estado" optionLabel="uf"
                                        [style]="{'border':'1px solid #00B5B8', 'width': '100%' }">
                                    </p-dropdown>
                                </div>

                                <div class="ui-g-12 ui-md-4 ui-lg-3">
                                    <label>Cidade</label>
                                    <p-dropdown id="cidade" autocomplete="off" [options]="listaCidade" [filter]="true"
                                        [disabled]="!enderecoSelecionado.ativo" [(ngModel)]="enderecoSelecionado.cidade"
                                        optionLabel="xmun" [style]="{'border':'1px solid #00B5B8', 'width': '100%' }">
                                    </p-dropdown>
                                </div>

                                <div class="ui-g-12 ui-md-4 ui-lg-10" style="margin-top: -2px;">
                                    <inputText id="logradouro" autocomplete="off" md="12" maxlength="80"
                                        [disabled]="!enderecoSelecionado.ativo"
                                        [(ngModel)]="enderecoSelecionado.logradouro" maxlength="15" label="logradoura">
                                    </inputText>
                                </div>
                                <inputText id="numero" md="2" autocomplete="off" label="Numero"
                                    [disabled]="!enderecoSelecionado.ativo" [(ngModel)]="enderecoSelecionado.numero">
                                </inputText>
                                <inputText id="complemento" autocomplete="off" md="10" maxlength="60"
                                    label="Complemento" [disabled]="!enderecoSelecionado.ativo"
                                    [(ngModel)]="enderecoSelecionado.complemento">
                                </inputText>
                                <inputText id="bairro" autocomplete="off" md="2" maxlength="50" label="Bairro"
                                    [disabled]="!enderecoSelecionado.ativo" [(ngModel)]="enderecoSelecionado.bairro">
                                </inputText>

                            </div>
                        </div>
                    </div>
                    <p-footer>
                        <div class="row">
                            <button class="mr-1" pButton icon="fa fa-check" label="Confirmar" (click)="salvarEndereco()"
                                [disabled]="!enderecoSelecionado.ativo"></button>
                            <button pButton icon="fa fa-times" label="Cancelar"></button>
                        </div>

                    </p-footer>
                </p-dialog>

                <p-dialog header="Telefone Fornecedor" [(visible)]="isVisibleTelefone" [modal]="true"
                    [closeOnEscape]="true" [style]="{'width': '20%'}" [responsive]="true" [minY]="70"
                    [maximizable]="false" [baseZIndex]="10000">
                    <div class="ui-g" style="height: 360px;">
                        <div class="ui-g-12">
                            <div class="row">
                                <div class="ui-g-12" style="font-size: 14px !important;font-family: sans-serif;">
                                    <p-selectButton [options]="statusTelefone" [(ngModel)]="telefoneSelecionado.ativo">
                                    </p-selectButton>
                                </div>

                                <div class="ui-g-12" style="position: relative;top: 2px;">
                                    <label>Tipo</label><br>
                                    <p-dropdown id="tipoTelefone" autoWidth="false" [filter]="true"
                                        [options]="listaTelefone" [(ngModel)]="telefoneSelecionado.tipo"
                                        [disabled]="!telefoneSelecionado.ativo" [style]="{'width':'100%'}">
                                    </p-dropdown>
                                </div>


                                <div class="ui-g-12" style="position: relative;top: 2px;"
                                    *ngIf="telefoneSelecionado.tipo == '1'">
                                    <label>Operadora</label><br>
                                    <p-dropdown id="operadora" autoWidth="false" [filter]="true"
                                        [options]="listaOperadora" [(ngModel)]="telefoneSelecionado.nmOperadora"
                                        (onChange)='loadOperadoras()' [style]="{'width':'100%'}"
                                        [disabled]="!telefoneSelecionado.ativo">
                                    </p-dropdown>

                                </div>

                                <div class="ui-g-12">
                                    <inputMask id="fone1" autocomplete="off" placeholder="(___) _ ____-____" md="12"
                                        label="Fone 01" [(ngModel)]="telefoneSelecionado.numero"
                                        [mask]="telefoneSelecionado.tipo == 1 ? '(999) 9 9999-9999':telefoneSelecionado.tipo == 2 ?'(999) 9999-9999':''"
                                        [disabled]="!telefoneSelecionado.ativo"></inputMask>

                                </div>

                            </div>
                        </div>
                    </div>

                    <p-footer>
                        <div class="row">
                            <button class="mr-1" pButton icon="fa fa-check" label="Confirmar" (click)="salvarTelefone()"
                                [disabled]="!telefoneSelecionado.ativo"></button>
                            <button pButton icon="fa fa-times" label="Cancelar"></button>
                        </div>
                    </p-footer>

                </p-dialog>
            </div>
        </div>
    </div>

</crud>
